# Day 7 Solutions
âŸ¨_split, IntâŸ© â† â€¢Import "util.bqn"
input â† â€¢FLines "inputs/07.txt"

# Create listing of âŸ¨path, dir/file name, size (if file)âŸ©
Step â† {lâ€¿p ğ•Š c: (âŠ‘"$ cd"â€¿"$ ls"â€¿"dir "âŠÂ·<4âŠ¸â†‘)â—¶âŸ¨
    {".." â‰¡ Â¯2â†‘ğ•© ? âŸ¨l, Â¯1â†“pâŸ© ; âŸ¨l, pâˆ¾<5â†“ğ•©âŸ©}
    {ğ•Š: âŸ¨l, pâŸ©}
    {âŸ¨lâˆ¾<âŸ¨p, 4â†“ğ•©âŸ©, pâŸ©}
    {sâ€¿nâ†' '=_split ğ•© â‹„ âŸ¨lâˆ¾<âŸ¨p, n, Int sâŸ©, pâŸ©}
  âŸ© c
}
listing â† â·âŠ‘ âŸ¨âŸ©â€¿âŸ¨âŸ© StepËœÂ´âŒ½ input

# Build Directory Tree
BDT â† {listing ğ•Š path:
  inDir â† (pathâ‰¡âŠ‘)Â¨âŠ¸/listing
  Proc â† {pathâ€¿nameâ€¿size: âŸ¨"file", name, sizeâŸ©;
          pathâ€¿name: listing BDT pathâˆ¾<name}
  âŸ¨"dir", Â¯1â†‘path, ProcÂ¨inDirâŸ©
}
tree â† listing BDT âŸ¨"/"âŸ©

# Part 1
sizes â† {ğ•Š âŸ¨"dir", name, contentsâŸ©:
  fileSizes â† 2âŠ‘Â¨("file"â‰¡âŠ‘)Â¨âŠ¸/contents
  dirSizes â† ğ•ŠÂ¨ ("dir"â‰¡âŠ‘)Â¨âŠ¸/contents
  âŸ¨(+Â´fileSizes) + +Â´âŠ‘Â¨dirSizesâŸ©âˆ¾âˆ¾dirSizes
} tree
â€¢Show +Â´1e5âŠ¸â‰¥âŠ¸/sizes

# Part 2
â€¢Show âŒŠÂ´(4e7âŠ¸â‰¥ âŠ‘âŠ¸-)âŠ¸/sizes
